 <!-- Mobile Toolbar -->
<ion-header no-border class="ion-hide-lg-up">
  <ion-toolbar>
    <ion-buttons slot="start">
    </ion-buttons>
    <!-- 
     <ion-button id="search-button"
      (click)="searchLoading()" class="search-button">
        Search
      </ion-button> -->
    <ion-searchbar
    class="searchbar"
    animated="true"
    searchIcon="none"
    placeholder="Search"
    (ionFocus)="searchBarFocus()"
    (ionBlur)="searchBarBlur()"
    (ionChange)="search($event)">
    <span class="hash">#</span>
  </ion-searchbar>
    <ion-buttons slot="end">
      <!-- Notifications -->
      <ion-button (click)="notificationsPage()">
        <img height="25" class="header-icons" src="../../../assets/icon/posts-notification-bell-grey.svg">
        <span style="color: #666; height: 25px; width: 25px; border-radius: 100px; position: relative; font-size: 1.4em; font-weight: 600;">{{notificationsLength}}</span>
      </ion-button>
      <ion-button id="my-documents-button" (click)="myPosts()" fill="clear">
        <ion-icon name="documents-outline" size="large"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>

  <!-- Refresher -->
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Spinner -->
  <ion-spinner *ngIf="searching" name="crescent"></ion-spinner>

  <!-- Desktop -->
  <ion-grid class="ion-hide-lg-down">
    <!-- Search & Filter -->
    <ion-row id="search-wrapper" class="ion-justify-content-center">
      <!-- Posts Page Icon -->
      <ion-col size="1" push="0.2" pull-lg="2">
        <ion-icon id="posts-icon" size="large" name="newspaper-outline"></ion-icon>
        <h3>| Posts</h3>
      </ion-col>
      <!-- Searchbar Element -->
      <ion-col size="2.5">
        <ion-searchbar
          class="searchbar-desktop"
          animated="true"
          (keyup.enter)="searchLoading()"
          cancelButtonText=""
          showCancelButton="true"
          placeholder="Search Posts by #Hashtags"
          (ionFocus)="searchBarFocus()"
          (ionBlur)="searchBarBlur()"
          (ionChange)="search($event)">
          <span class="hash-desktop">
            <ion-icon name="search-outline" style="font-size: 0.8em; color: #0055a5;"></ion-icon>
          </span>

        </ion-searchbar>
      </ion-col>
      <!-- Search Button -->
      <ion-col size="0.8">
        <div style="margin-top: 11px;"></div>
        <ion-button id="search-button" (click)="searchLoading()">
          Search
        </ion-button>
      </ion-col>
      <!-- Filter-Button -->
      <ion-col size="1.4">
        <div class="spacer-1x"></div>
        <div class="filter-message">
          <ion-icon name="filter-outline"></ion-icon>
          <p *ngIf="this.postFilter === 'mostc'" (click)="filterMenu()"> Most Comments</p>
          <p *ngIf="this.postFilter === 'mostu'" (click)="filterMenu()"> Most Upvotes</p>
          <p *ngIf="this.postFilter === 'mostf'" (click)="filterMenu()"> Most Followers</p>
          <p *ngIf="this.postFilter === 'newest'" (click)="filterMenu()"> Newest</p>
          <p *ngIf="this.postFilter === 'oldest'" (click)="filterMenu()"> Oldest</p>
        </div>
      </ion-col>
      <!-- Notifications -->
      <ion-col size="1" push="0.2">
        <!-- TODO: Switch to Grey Icon when Notifications count == 0 -->
        <div class="spacer-1x"></div>
        <img height="25" src="../../../assets/icon/posts-notification-bell-red.svg"/>
        <span id="notifications-count">3</span>
      </ion-col>
    </ion-row>
    
    <!-- Search message -->
    <ion-row id="search-message-wrapper">
      <ion-col size="12">
        <p>You can choose up to five hashtags. 
          Please seperate each tag with a comma ( , ). 
          Example: "Computers, Science, Technology".</p>
      </ion-col>
    </ion-row>

    <!-- Search Message Overlay -->
    <ion-row id="search-message-overlay">
      <ion-col size="12"></ion-col>
    </ion-row>

    <!-- If Filtering -->
    <ion-row class="ion-justify-content-center">
      <ion-col style="position: relative; top: -32px;" class="ion-text-center" size="12">
        <ion-spinner *ngIf="this.filtering" name="bubbles">Filtering</ion-spinner>
      </ion-col>
    </ion-row>

    <!-- Posts & SideBar -->
    <ion-row *ngIf="!this.filtering" class="ion-justify-content-center">
      <!-- Posts -->
      <ion-col id="posts-wrapper" size-md="7.5" size-lg="5" size-xl="4.5">
        <div class="post" *ngFor="let post of allPosts">
          <!-- Profile Header -->
          <ion-row>
            <!-- Profile Picture -->
            <ion-col class="ion-text-center" push="0.2" size="1">
              <img src="{{post.creatorProfilePicture}}" style="border-radius: 100px; height: 35xpx; width: 35px;">
            </ion-col>
            <!-- Post Creator's Name -->
            <ion-col push="0.2" size="10">
              <p class="post-name">{{post.creatorName}}</p>
              <p class="post-date">{{this.formatDistanceToNow(post.date)}}</p>
            </ion-col>
          </ion-row>
          <!-- Post Content -->
          <ion-row class="ion-justify-content-center">
            <!-- (click)="postPage(post)"  -->
            <!-- 1080x1350 -->
            <ion-col size="11">
              <p class="post-title">{{post.title}}</p>
              <div class="hashtags">
                <p class="hashtag" *ngFor="let tag of post.hashtags">
                  #{{tag}}
                </p>
              </div>
              <p class="no-tags" *ngIf="post.hashtags.length === 0">
                No #hashtags for this post
              </p>
              <p [ngClass]="{'show-less': showShortDesciption}" 
                class="post-content">
                {{post.post}}
                <button *ngIf="post.post.length > 400" class="show-more-or-less-button" type="button" (click)="alterDescriptionText(post.post)">
                  {{ showShortDesciption ? '... Read More': 'Show Less' }}
                </button>
              </p>
              
            </ion-col>
          </ion-row>
          <!-- Comment -->
          <ion-row class="ion-justify-content-center">
            <ion-col size="11.5">
              <ion-item  style="height: auto;" lines="none">
                <form (ngSubmit)="comment(post._id, this.userFullName, this.userEmail, this.userProfilePicture, this.commentForm.value)" [formGroup]="commentForm">
                  <ion-textarea
                      class="comment-input-mobile"
                      autogrow="true"
                      autocapitalize="true"
                      rows="5"
                      spellcheck="true"
                      wrap="soft"
                      type="text"
                      #postComment
                      placeholder="Add a Comment"
                      formControlName="comment">
                  </ion-textarea>
                  <!-- Comment Post Button -->
                  <ion-button
                    style="float: right;"
                    *ngIf="postComment.value.length >= 2;"
                    class="comment-post-button"
                    name="send"
                    type="submit">Post Comment
                  </ion-button>
                </form>
              </ion-item>
            </ion-col>
          </ion-row>
          <!-- Post Buttons -->
          <ion-row class="ion-justify-content-center">
            <!-- Upvote & Downvote-->
            <ion-col size="8">
              <app-up-down-vote-buttons [postID]="post._id" [postEmail]="post.creatorEmail"></app-up-down-vote-buttons>
            </ion-col>
            <!-- Follow & Comment -->
            <ion-col size="3">
              <app-follow-comment-buttons [postID]="post._id" [commentLength]="post.comments.length"></app-follow-comment-buttons>
            </ion-col>
          </ion-row>
        </div>
      </ion-col>
      <!-- Sidebar with User Info -->
      <ion-col size="2">
        <ion-row id="user-details">
          <ion-col size="12">
            <img id="posts-profile-picture" src="{{userProfilePicture}}">
            <span>{{userFullName}}</span>
            <div class="spacer"></div>
            <a class="my-post-button"  (click)="myPosts()">
              My Posts {{myPostsLength}}
            </a>
            <a class="following-button" (click)="following()">
              Following {{followedPostCount}}
            </a>
            <ion-button id="add-button"  (click)="addPost()">
              <ion-icon slot="start" name="add-outline" style="color: white; font-size: 2em;"></ion-icon>
              Add Post
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Fab placed to the bottom end -->
  <ion-fab [@inOutAnimation] id="fab-wrapper" class="ion-hide-lg-up" vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button id="add-post-button" (click)="addPost()">
        <ion-icon name="add" size="large"></ion-icon>
      </ion-fab-button>
  </ion-fab>
  <!-- Mobile -->
  <ion-grid class="ion-hide-lg-up">
 
    <!-- <ion-row class="filter-toolbar-wrapper ion-hide-lg-up ion-justify-content-center">
      <ion-col size-xs="11" size-sm="10" size-md="10" size-lg="8" size-xl="6">
        <ion-toolbar class="filter-toolbar">
          <ion-buttons slot="start">
            <p *ngIf="this.postFilter === 'mostc'" class="filter-message"><span>Filter</span>: Most Comments</p>
            <p *ngIf="this.postFilter === 'mostu'" class="filter-message"><span>Filter</span>: Most Upvotes</p>
            <p *ngIf="this.postFilter === 'mostf'" class="filter-message"><span>Filter</span>: Most Followers</p>
            <p *ngIf="this.postFilter === 'newest'" class="filter-message"><span>Filter</span>: Newest</p>
            <p *ngIf="this.postFilter === 'oldest'" class="filter-message"><span>Filter</span> {{this.postFilter}}</p>
          </ion-buttons>
          <ion-buttons slot="end">
            <ion-button (click)="filterMenu()">
              <ion-icon class="filter-icon" slot="start" name="filter"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-col>
    </ion-row> -->
    <!-- Followed Posts and My Posts -->
    <!-- <ion-row class="top-button-wrapper ion-hide-lg-up ion-justify-content-center">
      <div class="spacer"></div>
      <ion-col class="ion-text-left" push-xs="1" size-xs="12" size-sm="11" size-md="10">
        <ion-button class="toolbar-orange-button" (click)="following()">
          <ion-icon class="header-icons" src="../../assets/icon/following.svg"></ion-icon>
          Following ({{this.followedPostCount}})
        </ion-button>
        <ion-button class="toolbar-orange-button" (click)="myPosts()">
          <ion-icon class="header-icons" name="list"></ion-icon>
          My Posts ({{this.myPostsLength}})
        </ion-button>
      </ion-col>
    </ion-row> -->
    <!-- Posts -->
    <ion-row class="ion-justify-content-center">
      <!-- Posts -->
      <ion-col *ngIf="noPosts" size-xs="12" size-sm="11" size-md="10" size-lg="8" size-xl="5">
        <p>No Posts with those #Hashtags. Please try again.</p>
      </ion-col>
      <ion-col size-xs="12" size-sm="11" pull-md="1.5" size-md="8" size-lg="8" size-xl="5"> 
        <div class="post" *ngFor="let post of allPosts">
        <!-- Profile Header -->
        <ion-row class="ion-justify-content-center">
              <!-- Profile Picture -->
              <ion-col size="1">
                <img src="{{post.creatorProfilePicture}}" style="background: #999; border-radius: 100px; height: 35xpx; width: 35px;">
              </ion-col>

              <!-- Post Creator's Name -->
              <ion-col push="0.2" size="10">
                <p class="post-name">{{post.creatorName}}</p>
                <p class="post-date">{{this.formatDistanceToNow(post.date)}}</p>
              </ion-col>

        </ion-row>
        <!-- Post Content -->
        <ion-row class="ion-justify-content-center">
          <!-- (click)="postPage(post)"  -->
          <!-- 1080x1350 -->
          <ion-col size="11">
            <p class="post-title">{{post.title}}</p>
            <div class="hashtags">
              <p class="hashtag" *ngFor="let tag of post.hashtags">
                #{{tag}}
              </p>
            </div>
            <p class="no-tags" *ngIf="post.hashtags.length === 0">
              No #hashtags for this post
            </p>
            <p [ngClass]="{'show-less': showShortDesciption}" class="post-content">{{post.post}}</p>
            <button *ngIf="post.post.length > 400" class="show-more-or-less-button" type="button" (click)="alterDescriptionText(post.post)">
              {{ showShortDesciption ? '... Read More': 'Show Less ...' }}
            </button>
          </ion-col>
        </ion-row>
        <!-- Comment -->
        <ion-row class="ion-justify-content-center">
          <ion-col size="12">
            <ion-item  style="height: auto;" lines="none">
              <form (ngSubmit)="comment(post._id, this.userFullName, this.userEmail, this.userProfilePicture, this.commentForm.value)" [formGroup]="commentForm">
                <ion-textarea
                  (ionBlur)="this.commentBlur()"
                  (ionFocus)="this.commentFocus()"
                  class="comment-input-mobile"
                  autogrow="true"
                  autocapitalize="true"
                  rows="1"
                  spellcheck="true"
                  wrap="soft"
                  type="text"
                  #postComment
                  placeholder="Add a Comment"
                  formControlName="comment">
                </ion-textarea>

                <!-- Textarea that appears after User focuses on Comment Input -->
                <!-- Comment Post Button -->
                <ion-button
                  style="float: right;"
                  *ngIf="postComment.value.length >= 2;"
                  class="comment-post-button"
                  name="send"
                  type="submit">Post Comment
                </ion-button>
              </form>
            </ion-item>
          </ion-col>
          </ion-row>
        <!-- Post Buttons -->
        <ion-row class="ion-justify-content-center">
          <!-- Upvote & Downvote-->
          <ion-col size="8">
            <app-up-down-vote-buttons [postID]="post._id" [postEmail]="post.creatorEmail"></app-up-down-vote-buttons>
          </ion-col>
          <!-- Follow & Comment -->
          <ion-col size="3">
            <app-follow-comment-buttons [postID]="post._id" [commentLength]="post.comments.length"></app-follow-comment-buttons>
          </ion-col>
        </ion-row>
        </div>
      </ion-col>
    </ion-row>
    <!-- Spacer -->
    <div style="margin-bottom: 200px;" ></div>
  </ion-grid>

</ion-content>