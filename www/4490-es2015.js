(self.webpackChunkfind_you_future_app=self.webpackChunkfind_you_future_app||[]).push([[4490],{40532:function(e,t,i){"use strict";i.r(t),i.d(t,{RepliesPagePageModule:function(){return m}});var o=i(38583),n=i(90665),s=i(19039),r=i(21382),l=i(28684),c=i(88720);const a=[{path:"",component:l.o}];let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[r.Bz.forChild(a)],r.Bz]}),e})(),m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[o.ez,n.u5,n.UX,s.Pc,p]]}),e})()},28684:function(e,t,i){"use strict";i.d(t,{o:function(){return Z}});var o=i(64762),n=i(19039),s=i(39181),r=i(69166),l=i(20445),c=i(26215),a=i(1473),p=i(88720);let m=(()=>{class e{constructor(e,t,i){this.popoverController=e,this.alertController=t,this.loadingController=i}ngOnInit(){}selectOption(e){switch(this.selection=e.detail.value,console.log(this.selection),this.selection){case"edit":console.log("Editting!");break;case"delete":console.log("Deleting!"),this.presentAlertConfirm();break;case"report":console.log("Reporting!")}}dismiss(){this.popoverController.dismiss({data:this.selection})}presentAlertConfirm(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Delete?",message:"Are you sure?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"Yes",handler:()=>(0,o.mG)(this,void 0,void 0,function*(){console.log("Deleting"),yield this.deleteLoading(),yield e.dismiss()})}]});yield e.present()})}deleteLoading(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield this.loadingController.create({cssClass:"my-custom-class",message:"Deleting Reply ...",duration:1e3});yield e.present(),yield e.onDidDismiss(),console.log("Loading dismissed!")})}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(n.Dh),p.Y36(n.Br),p.Y36(n.HT))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-reply-options-popover"]],decls:16,vars:0,consts:[["name","reply-option-menu",3,"ionChange"],["lines","none"],["value","delete"],["value","edit"],["value","report"],["button","","lines","none",1,"ion-text-center",3,"click"],[2,"color","#e3405f"]],template:function(e,t){1&e&&(p.TgZ(0,"ion-radio-group",0),p.NdJ("ionChange",function(e){return t.selectOption(e)}),p.TgZ(1,"ion-item",1),p.TgZ(2,"ion-label"),p._uU(3,"Delete"),p.qZA(),p._UZ(4,"ion-radio",2),p.qZA(),p.TgZ(5,"ion-item",1),p.TgZ(6,"ion-label"),p._uU(7,"Edit"),p.qZA(),p._UZ(8,"ion-radio",3),p.qZA(),p.TgZ(9,"ion-item",1),p.TgZ(10,"ion-label"),p._uU(11,"Report"),p.qZA(),p._UZ(12,"ion-radio",4),p.qZA(),p.TgZ(13,"ion-item",5),p.NdJ("click",function(){return t.dismiss()}),p.TgZ(14,"ion-label",6),p._uU(15,"Close"),p.qZA(),p.qZA(),p.qZA())},directives:[n.se,n.QI,n.Ie,n.Q$,n.B7,n.U5],styles:[""]}),e})();var u=i(90665),d=i(50806),g=i(38583);const h=["replyTextArea"];function f(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"ion-row",22),p.TgZ(1,"ion-col",9),p.TgZ(2,"ion-col",9),p.TgZ(3,"ion-item",10),p.TgZ(4,"ion-avatar",11),p._UZ(5,"img",12),p.qZA(),p.TgZ(6,"ion-label"),p.TgZ(7,"h6"),p.TgZ(8,"span",23),p._uU(9),p.qZA(),p._UZ(10,"br"),p._uU(11),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(12,"ion-col",9),p.TgZ(13,"p",24),p._uU(14),p.qZA(),p.qZA(),p.TgZ(15,"ion-col",25),p.TgZ(16,"ion-button",26),p.NdJ("click",function(){return p.CHM(e),p.oxw().optionsPopover()}),p._UZ(17,"ion-icon",27),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&e){const e=t.$implicit;p.xp6(5),p.s9C("src",e.userProfilePicture,p.LSH),p.xp6(4),p.Oqu(e.userFullName),p.xp6(2),p.hij("",e.date," ago"),p.xp6(3),p.Oqu(e.reply)}}let Z=(()=>{class e{constructor(e,t,i,o,n,s,r,l,a,p){this.formBuilder=e,this.modal=t,this.popover=i,this.navParams=o,this.loading=n,this.profile=s,this.posts=r,this.alert=l,this.postEmitterService=a,this.notificationsService=p,this.replies$=new c.X([]),this.tabBar=document.getElementById("myTabBar"),this.votes=document.getElementById("votes")}ngOnInit(){this.profile.getUserDetails().subscribe(e=>{this.commentUserProfilePicture=e.profilePicture}),this.repliesForm=this.formBuilder.group({reply:[""]}),this.replies$.next(this.navParams.get("replies").reverse()),this.replies$.subscribe(e=>{this.replies=e;for(let t of this.replies)t.isEditable=!1,t.userEmail==this.userEmail&&(t.isEditable=!0)}),this.postID=this.navParams.get("postID"),this.commentContents=this.navParams.get("comment"),this.commentID=this.navParams.get("commentID"),this.commentUserFullName=this.navParams.get("commentUserFullName"),this.commentUserEmail=this.navParams.get("commentUserEmail"),this.commentDate=this.navParams.get("commentDate"),this.userFullName=this.navParams.get("userFullName"),this.userEmail=this.navParams.get("userEmail"),this.commentUserProfilePicture=this.navParams.get("userProfilePicture")}cancel(){console.log("cancelling comment..."),this.modal.dismiss()}refreshRepliesAmount(){this.postEmitterService.postPageRefresh()}reply(e){return(0,o.mG)(this,void 0,void 0,function*(){yield this.repliesForm.reset(),yield console.log("replying to comment..."),yield this.posts.replyComment(this.commentID,this.postID,e,this.userFullName,this.userEmail,this.commentUserProfilePicture,this.commentUserFullName,this.commentUserEmail).subscribe(e=>{let t,i=[];for(const r of e.comments)if(r._id==e.comment){t=r;for(let e=0;e<r.replies.length;e++)i.push(r.replies[e])}let o=e.comments,n=e.userEmail,s=e.replies;for(const r of o){r.repliesLength=r.replies.length,r.isUser=!1,r.canDeleteComment=!1,r.canReport=!0,r.date=(0,l.Z)(new Date(r.date),{includeSeconds:!1,addSuffix:!1}),r.userEmail===n&&(r.isUser=!0,r.canDeleteComment=!0,r.canReport=!1);for(let e=0;r.replies.length>e;e++)r.replies[e].date=(0,l.Z)(new Date(r.replies[e].date),{addSuffix:!1}),s.push(r.replies[e])}this.replies=i,i.reverse(),this.posts.commentsSubject$.next(o.reverse()),this.replies$.next(this.replies.reverse()),console.log("From replyComment"),console.log(e),this.notificationsService.replyNotification(this.userEmail,this.commentUserEmail,this.postID,t,e.newReply).subscribe(),console.log(this.replyTextArea.value),this.replyTextArea.value=void 0}),yield this.repliesLoading()})}deleteReply(e){return(0,o.mG)(this,void 0,void 0,function*(){console.log("Deleting reply with id ",e),yield this.posts.deleteReply(e,this.commentID,this.postID).subscribe(e=>{let t;console.log(e);let i=[],o=e.comments,n=e.userEmail,s=e.replies;for(const r of o)if(r._id==e.comment){t=r;for(let e=0;e<r.replies.length;e++)i.push(r.replies[e])}for(const r of o){r.repliesLength=r.replies.length,r.isUser=!1,r.canDeleteComment=!1,r.canReport=!0,r.date=(0,l.Z)(new Date(r.date),{includeSeconds:!1,addSuffix:!1}),r.userEmail==n&&(r.isUser=!0,r.canDeleteComment=!0,r.canReport=!1);for(let e=0;r.replies.length>e;e++)r.replies[e].date=(0,l.Z)(new Date(r.replies[e].date),{addSuffix:!1}),s.push(r.replies[e])}this.replies=i,this.posts.commentsSubject$.next(o.reverse()),this.replies$.next(this.replies.reverse())})})}repliesLoading(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield this.loading.create({message:"Replying to Comment...",duration:2e3});yield this.refreshRepliesAmount(),yield e.present(),yield e.onDidDismiss(),console.log("Loading dismissed!")})}confirmAlert(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield this.alert.create({cssClass:"success-alert",message:"Your comment has been edited.",buttons:["OK"]});yield e.present()})}ScrollToReply(){document,console.log(this.content.getScrollElement().then(e=>this.content.scrollToPoint(0,e.scrollHeight,100)))}replyContent(e){console.log(e),this.replyValue=e.detail.value}optionsPopover(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield this.popover.create({component:m,cssClass:"my-custom-class",translucent:!0});yield e.present();const{role:t}=yield e.onDidDismiss();console.log("onDidDismiss resolved with role",t)})}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(u.qu),p.Y36(n.IN),p.Y36(n.Dh),p.Y36(n.X1),p.Y36(n.HT),p.Y36(s.H),p.Y36(r.P),p.Y36(n.Br),p.Y36(d.p),p.Y36(a.T))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-replies-page"]],viewQuery:function(e,t){if(1&e&&(p.Gf(n.W2,7),p.Gf(h,7)),2&e){let e;p.iGM(e=p.CRH())&&(t.content=e.first),p.iGM(e=p.CRH())&&(t.replyTextArea=e.first)}},decls:38,vars:6,consts:[[1,"ion-hide-md-down"],["slot","start"],["slot","end"],[3,"click"],[1,"ion-hide-lg-up"],["id","back-arrow-icons","name","arrow-back",3,"click"],[3,"scrollEvents"],[2,"background-color","white","padding","2em 0 2em 0em"],[1,"ion-justify-content-center"],["size","11"],["lines","none"],["slot","start",1,"comment-avatar"],[3,"src"],[2,"color","#0055a5","font-weight","600"],["class","ion-justify-content-center ion-align-items-start reply-wrapper",4,"ngFor","ngForOf"],[1,"ion-hide-lg-up","add-comment-footer"],["size","10",2,"display","inline-block","height","40px"],["autocapitalize","true","rows","1","spellcheck","true","wrap","soft","type","text","placeholder","Add a Reply",2,"display","inline",3,"ionChange"],["replyTextArea",""],["size","1",2,"display","inline-block","height","50px",3,"click"],[2,"--background","none"],["slot","start","name","send",2,"font-size","1.8em","color","#0055a5"],[1,"ion-justify-content-center","ion-align-items-start","reply-wrapper"],[2,"color","#000"],[1,"reply-text"],["size","2",1,"ion-float-right"],[2,"--background","none","position","relative","left","32px",3,"click"],["name","ellipsis-vertical-outline",1,"more-icon"]],template:function(e,t){1&e&&(p.TgZ(0,"ion-header",0),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-title",1),p._uU(3,"Replies"),p.qZA(),p.TgZ(4,"ion-buttons",2),p.TgZ(5,"ion-button",3),p.NdJ("click",function(){return t.cancel()}),p._uU(6," cancel "),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(7,"ion-header",4),p.TgZ(8,"ion-toolbar"),p.TgZ(9,"ion-icon",5),p.NdJ("click",function(){return t.cancel()}),p.qZA(),p.TgZ(10,"ion-title",2),p._uU(11,"Replies"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(12,"ion-content",6),p.TgZ(13,"div",7),p.TgZ(14,"ion-row",8),p.TgZ(15,"ion-col",9),p.TgZ(16,"ion-item",10),p.TgZ(17,"ion-avatar",11),p._UZ(18,"img",12),p.qZA(),p.TgZ(19,"ion-label"),p.TgZ(20,"h6"),p.TgZ(21,"span",13),p._uU(22),p.qZA(),p._UZ(23,"br"),p._uU(24),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(25,"ion-row",8),p.TgZ(26,"ion-col",9),p.TgZ(27,"p"),p._uU(28),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.YNc(29,f,18,4,"ion-row",14),p.qZA(),p.TgZ(30,"ion-footer",15),p.TgZ(31,"ion-row",8),p.TgZ(32,"ion-col",16),p.TgZ(33,"ion-textarea",17,18),p.NdJ("ionChange",function(e){return t.replyContent(e)}),p.qZA(),p.qZA(),p.TgZ(35,"ion-col",19),p.NdJ("click",function(){return t.reply(t.replyValue)&&t.ScrollToReply()}),p.TgZ(36,"ion-button",20),p._UZ(37,"ion-icon",21),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(12),p.Q6J("scrollEvents",!0),p.xp6(6),p.s9C("src",t.commentUserProfilePicture,p.LSH),p.xp6(4),p.Oqu(t.commentUserFullName),p.xp6(2),p.hij("",t.commentDate," "),p.xp6(4),p.Oqu(t.commentContents),p.xp6(1),p.Q6J("ngForOf",t.replies))},directives:[n.Gu,n.sr,n.wd,n.Sm,n.YG,n.gu,n.W2,n.Nd,n.wI,n.Ie,n.BJ,n.Q$,g.sg,n.fr,n.g2,n.j9],styles:["ion-item[_ngcontent-%COMP%]{--background:none;position:relative;right:16px}.add-comment-footer[_ngcontent-%COMP%]{background:rgba(213,232,236,.3);height:80px;font-size:1.3em;border-top:6px solid #0055a5;padding-top:4px}.more-icon[_ngcontent-%COMP%]{color:#0055a5;font-size:1.3em}.reply-wrapper[_ngcontent-%COMP%]{padding:10px;margin:16px;box-shadow:1px 10px 10px rgba(0,0,0,.05);background:#fff}#reply-avatar[_ngcontent-%COMP%]{height:30px;width:30px;border-radius:50px;position:relative;top:7px}.reply-name[_ngcontent-%COMP%]{font-weight:700;margin:.5em 0}#reply-date[_ngcontent-%COMP%]{font-size:.7em;color:#999}#back-arrow-icons[_ngcontent-%COMP%]{font-size:1.5em;position:relative;left:24px;top:8px}"]}),e})()}}]);